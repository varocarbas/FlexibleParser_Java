package UnitParser;

import InternalUnitParser.Operations.*;

public class ErrorInfo
{
    /**Error type.**/
    public final UnitP.ErrorTypes Type;
    /**Exception handling type.**/
    public final UnitP.ExceptionHandlingTypes ExceptionHandling;
    /**Error message.**/
    public final String Message;  
    
    /**Initialises a new ErrorInfo instance.**/
    public ErrorInfo() 
    {
        Type = UnitP.ErrorTypes.None;
        ExceptionHandling = UnitP.ExceptionHandlingTypes.AlwaysTriggerException;
        Message = "";      
    }
    
    /**
    Initialises a new ErrorInfo instance.
    @param errorInfo ErrorInfo variable whose information will be used.
	**/
    public ErrorInfo(ErrorInfo errorInfo) 
    {
        if (errorInfo == null) errorInfo = new ErrorInfo();

        Type = errorInfo.Type;
        ExceptionHandling = errorInfo.ExceptionHandling;
        Message = errorInfo.Message;
    }
    
    /**Initialises a new ErrorInfo instance.
    @param type Member of the UnitP.ErrorTypes enum to be used.
    **/    
    public ErrorInfo(UnitP.ErrorTypes type) throws Exception
    {
    	this(type, UnitP.ExceptionHandlingTypes.NeverTriggerException);
    }
    
    /**Initialises a new ErrorInfo instance.
    @param type Member of the UnitP.ErrorTypes enum to be used.
    @param exceptionHandling Member of the UnitP.ExceptionHandlingTypes enum to be used.
    **/
    public ErrorInfo(UnitP.ErrorTypes type, UnitP.ExceptionHandlingTypes exceptionHandling) throws Exception
    {
        Type = type;
        ExceptionHandling = exceptionHandling;
        Message = GetMessage(type);

        if (type != UnitP.ErrorTypes.None && ExceptionHandling == UnitP.ExceptionHandlingTypes.AlwaysTriggerException)
        {
            throw new Exception(Message);
        }  
    } 
    
    private String GetMessage(UnitP.ErrorTypes type)
    {
        String outString = "";

        if (type == UnitP.ErrorTypes.InvalidOperation)
        {
            outString = "Invalid Operation. Some operands are incompatible among them or refer to invalid units.";
        }
        else if (type == UnitP.ErrorTypes.InvalidUnit)
        {
            outString = "Invalid Input. The input string doesn't match any supported unit.";
        }
        else if (type == UnitP.ErrorTypes.NumericError)
        {
            outString = "Numeric Error. An invalid mathematical operation has been performed.";
        }
        else if (type == UnitP.ErrorTypes.NumericParsingError)
        {
            outString = "Numeric Parsing Error. The input doesn't match the expected number + space + unit format.";
        }
        else if (type == UnitP.ErrorTypes.InvalidUnitConversion)
        {
            outString = "Invalid Unit Conversion. The unit conversion cannot be performed with these inputs.";
        }

        return outString;
    }
    
    public boolean Equals(ErrorInfo other)
    {
        return
        (
            other == null ? false :
            Equals.ErrorsAreEqual(this, other)
        );
    }

    @Override
    public boolean equals(Object obj)
    {
        return Equals((ErrorInfo)obj);
    }

    @Override
    public int hashCode() { return 0; }
}
